<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¬¡ã“ãä¹è“®å®ç‡ˆ -çœŸãƒªã‚¢ãƒ«-</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        :root { 
            --tile-ivory: #fefef2;
            --tile-side: #e5e5d5;
            --table-green: radial-gradient(circle, #2d5a27 0%, #1a3a16 100%);
        }
        body { margin: 0; background: var(--table-green); color: #fff; font-family: "serif"; overflow: hidden; touch-action: manipulation; -webkit-user-select: none; }
        #game-ui { width: 100vw; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: space-around; padding: 10px; box-sizing: border-box; }

        .tile {
            width: 44px; height: 60px; background: var(--tile-ivory); border-radius: 4px;
            box-shadow: inset 0 2px 3px #fff, 0 3px 0 var(--tile-side), 0 5px 0 #999, 0 8px 12px rgba(0,0,0,0.6);
            display: flex; align-items: center; justify-content: center; position: relative;
        }
        .tile-content { font-size: 3.2rem; line-height: 1; filter: drop-shadow(0.5px 0.5px 0.5px rgba(0,0,0,0.5)); }
        .p-red { color: #d32f2f; }
        .p-mix { color: #1565c0; text-shadow: 1px 1px 0 #d32f2f; }
        .p-black { color: #222; }

        #main-msg { font-size: 2rem; text-align: center; font-weight: bold; text-shadow: 0 0 15px #ff0000; min-height: 70px; width: 90%; z-index: 10; }
        .btn-pachinko { 
            padding: 15px 50px; font-size: 1.6rem; border-radius: 50px; border: 4px solid #ffd700; 
            background: linear-gradient(to bottom, #ff4444, #880000); color: white; 
            box-shadow: 0 0 20px rgba(255,0,0,0.6); cursor: pointer; z-index: 20;
            position: relative;
        }
        .btn-pachinko:active { transform: scale(0.95); }

        #cut-in { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); z-index: 100; display: none; text-align: center; }
        .big-tile { width: 130px; height: 180px; box-shadow: 0 0 50px rgba(255,255,0,0.8); }
        .big-tile .tile-content { font-size: 8rem; }

        #slot-section { display: none; text-align: center; width: 100%; }
        .slot-display { display: flex; gap: 10px; margin: 20px 0; justify-content: center; }
        .spinning { animation: blur-spin 0.05s infinite; }
        @keyframes blur-spin { 0% { transform: translateY(-2px); filter: blur(1px); } 100% { transform: translateY(2px); filter: blur(3px); } }
        #rainbow-flash { position: fixed; inset: 0; display: none; pointer-events: none; z-index: 150; animation: rainbow 0.15s infinite; opacity: 0.3; }
        @keyframes rainbow { 0% { background: red; } 20% { background: yellow; } 40% { background: green; } 60% { background: cyan; } 80% { background: blue; } 100% { background: magenta; } }
    </style>
</head>
<body>

<div id="game-ui">
    <div id="main-msg">æ¬¡ã“ãä¹è“®å®ç‡ˆ</div>
    <div id="hand-display" style="display: flex; gap: 2px; flex-wrap: wrap; justify-content: center;"></div>
    
    <div id="action-area">
        <button id="start-btn" class="btn-pachinko" onclick="runScenario()">æ‰“ ã¤</button>
    </div>

    <div id="slot-section">
        <div class="slot-display">
            <div class="tile big-tile"><span class="tile-content p-mix">ğŸ€œ</span></div>
            <div id="spin-tile" class="tile big-tile spinning"><span class="tile-content p-black">ï¼Ÿ</span></div>
            <div class="tile big-tile"><span class="tile-content p-mix">ğŸ€</span></div>
        </div>
        <p style="color:#ffd700; font-weight:bold; font-size:1.5rem;">é€£æ‰“ã—ã‚ï¼ï¼ï¼</p>
        <button class="btn-pachinko" onclick="handleTsumo()">ãƒ„ãƒ¢ï¼ï¼</button>
    </div>
</div>

<div id="cut-in">
    <div id="cut-in-label" style="font-size: 1.8rem; color: #ff0000; font-weight:bold; background: rgba(0,0,0,0.8); padding: 5px 15px; border-radius: 8px; margin-bottom: 10px; border: 2px solid gold;">æ±å®¶ï¼šãƒ„ãƒ¢ï¼ï¼</div>
    <div class="tile big-tile"><span class="tile-content p-mix">ğŸ€</span></div>
</div>
<div id="rainbow-flash"></div>

<script>
    const handSymbols = ["ğŸ€™","ğŸ€™","ğŸ€™","ğŸ€š","ğŸ€›","ğŸ€œ","ğŸ€","ğŸ€","ğŸ€Ÿ","ğŸ€ ","ğŸ€¡","ğŸ€¡","ğŸ€¡"];
    const quotes = ["ãƒ„ãƒœãŒã‚ã‹ã‚“ãªã„ã§ã™","æ‰¿çŸ¥ã™ã‚‹ã£ã¦ã„ãŸã‚ˆãªï¼ï¼Ÿ","æ¬¡ã“ãä¹è“®å®ç‡ˆï¼ğŸ‘¶","ã™ã”ã„ã§ã™ã‘ã©ã€ã‚¢ã‚¬ã£ã¦ã¯ãªã„ã§ã™ã‚ˆã­ï¼Ÿ","ã‚ãƒ¼ãã‚‚ã¡ã„","é€†ã«ã‚¢ã‚¬ã‚Œã‚‹ã¨æ€ã„ã¾ã™ï¼Ÿ"];
    
    const msg = document.getElementById('main-msg');
    const handDiv = document.getElementById('hand-display');
    const cutIn = document.getElementById('cut-in');

    function wait(ms) { return new Promise(r => setTimeout(r, ms)); }
    function vibrate(ms) { if (navigator.vibrate) navigator.vibrate(ms); }

    function createTile(symbol) {
        const t = document.createElement('div');
        t.className = 'tile';
        const c = document.createElement('span');
        c.className = 'tile-content';
        c.innerText = symbol;
        if (symbol === "ğŸ€™") c.classList.add('p-red');
        else if (symbol.match(/[ğŸ€š-ğŸ€¡]/)) c.classList.add('p-mix');
        else c.classList.add('p-black');
        t.appendChild(c);
        return t;
    }

    async function runScenario() {
        document.getElementById('start-btn').style.display = 'none';
        handDiv.innerHTML = '';
        
        // é…ç‰Œ
        for(let s of handSymbols) {
            handDiv.appendChild(createTile(s));
            vibrate(20); await wait(120);
        }

        await wait(1500);
        msg.innerText = "åŒ—å®¶ï¼šãƒªãƒ¼ãƒ..."; await wait(1500);
        msg.innerText = "æ±å®¶ï¼šãƒªãƒ¼ãƒ..."; await wait(1800);
        
        msg.style.color = "yellow";
        msg.innerText = "æ¿€ ç†±";
        gsap.fromTo(msg, {scale: 0.5}, {scale: 1.3, duration: 0.5, ease: "back.out"});
        await wait(1800);

        msg.style.color = "red";
        msg.innerText = "ä¹è“®å®ç‡ˆè´ç‰Œï¼ï¼"; await wait(2500);
        
        msg.style.color = "white";
        msg.innerText = "è¥¿å®¶ï¼šãƒ„ãƒ¢åˆ‡ã‚Š..."; await wait(1500);
        msg.innerText = "åŒ—å®¶ï¼šãƒ„ãƒ¢åˆ‡ã‚Š..."; await wait(1500);
        msg.innerText = "æ±å®¶ã®ãƒ„ãƒ¢ç•ª..."; await wait(2500);

        if (Math.random() < 0.9) {
            const q = quotes[Math.floor(Math.random() * quotes.length)];
            cutIn.style.display = 'block';
            gsap.to(cutIn, {scale: 1, duration: 0.4, ease: "back.out"});
            vibrate([300, 100, 300]);
            await wait(2800);
            alert(`æ±å®¶ã€Œ${q}ã€\n\nã‚¢ã‚¬ãƒªç‰Œï¼šå…­ç­’(ğŸ€)\n2000ã‚ªãƒ¼ãƒ«ã€‚çµ‚äº†ã€‚`);
            location.reload();
        } else {
            msg.innerText = "å¥‡è·¡ã®ãƒ„ãƒ¢ç•ª...ï¼";
            document.getElementById('slot-section').style.display = 'block';
        }
    }

    async function handleTsumo() {
        document.getElementById('slot-section').style.display = 'none';
        const spin = document.getElementById('spin-tile');
        spin.classList.remove('spinning');
        await wait(1200);
        const sub = Math.random();
        if (sub < 0.989) {
            spin.innerHTML = '<span class="tile-content p-black">ğŸ€‚</span>';
            alert("è¥¿å®¶ï¼šãƒ­ãƒ³ã€‚1000ç‚¹ã€‚"); location.reload();
        } else if (sub < 0.999) {
            spin.innerHTML = '<span class="tile-content p-mix">ğŸ€›</span>';
            alert("æ¸…ä¸€è‰²ãƒ»å¹³å’Œã€‚2000-4000ã€‚"); location.reload();
        } else {
            document.getElementById('rainbow-flash').style.display = 'block';
            spin.innerHTML = '<span class="tile-content p-mix">ğŸ€</span>';
            msg.innerText = "ä¹ è“® å® ç‡ˆ ï¼ï¼";
            vibrate([500, 100, 500, 100, 1000]);
            await wait(4000); alert("ä¼èª¬é”æˆï¼ï¼"); location.reload();
        }
    }
</script>
</body>
</html>
