<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>猛虎電算室・計算結果報告 (ag-Grid実装)</title>
    
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-grid.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-theme-alpine.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Train+One&display=swap'); /* 筆記体のようなフォント */

        body {
            font-family: 'Meiryo UI', sans-serif;
            margin: 0;
            background-color: #f6f6f6;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzgiIGhlaWdodD0iNzgiIHZpZXdCb3g9IjAgMCA3OCA3OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiMwMDAwMDAiPjxwYXRoIGQ9Ik0wIDc4VjcwLjUxNkw1LjQzNSA2Mi41SDcuNjVMOCA2My41VjcwLjUxNkwxLjgyIDc4SDB6TTcwLjU2NSAwbC01LjQzNSA3LjQ4NEg3MC4zNVY3Ljk1OEwxLjgyIDc4SDcuNjVMOCA3MC41MTRWNjIuNTFoNy42MTRsMS42MjggNC4zNzVMMCA3OC4xODJWMjcuMTdMOCA3Mi44MTRWNjIuNTFoNjg4eiIvPjxwYXRoIGQ9Ik0zOSAwTDMyLjk2NSA3LjQ4NEgzNC44NXY3Ljk1OEw0Ni43OTUgNjIuNSAzOS41OTUgMzAiLz48cGF0aCBkPSJNNzguMTggMTkuNTc1TDcyLjMxIDMyLjY5NUw2MS43MjQgMTYuNjIzIDcwLjU2NSA3LjQ4NEg2NC41VjcuOTU4TDc4LjE4IDI2LjY3VjE5LjU3NXoiLz48cGF0aCBkPSJNMCAwVjcuNDg0SDcuNjVWMi42NzNMMTIuNCAwSDd6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3IDApIi8+PHBhdGggZD0iTTcuNjU0IDMyLjY5NWwtNS40MyA3LjQ4NGg0OS4xNWwzLjkzLTcuNDg0eiIvPjxwYXRoIGQ9Ik02NC43NDIgMjUuMTg3bDUuNTM0IDcuNTA4IDcuNjA0LTMuMzk1VjEzLjczNHoiLz48cGF0aCBkPSJNMCA3MC41MTZWMjcuMTdMMjEuNjcgMS41NiAyMS44NCAwSDc1LjY1VjcuNDg0SDY4VjEzLjY1NWw1LjAzMiA2Ljg4MS01LjU1NiA3LjU1IDcuNjA0LTMuMzk1eiIvPjwvZz48L2c+PC9zdmc+'); /* タイガー柄SVG */
            background-size: 78px 78px;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 5px solid #F8C300; /* 阪神タイガースの黄色 */
        }

        .header {
            background-color: #000; /* 黒 */
            color: #F8C300; /* 黄色 */
            padding: 15px 20px;
            text-align: center;
            border-bottom: 5px solid #F8C300;
            margin: -30px -30px 30px -30px; /* 親要素のパディングを相殺して左右いっぱいに */
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .header h1 {
            font-family: 'Train One', cursive; /* 筆記体フォント */
            margin: 0;
            font-size: 2.5em;
            letter-spacing: 2px;
            text-shadow: 3px 3px 5px rgba(0,0,0,0.5);
        }
        .header img.logo-left {
            position: absolute;
            left: 20px;
            height: 60px; /* ロゴの高さ */
            object-fit: contain;
        }
        .header img.logo-right {
            position: absolute;
            right: 20px;
            height: 60px; /* ロゴの高さ */
            object-fit: contain;
        }

        .section-title {
            font-size: 1.8em;
            font-weight: bold;
            color: #000; /* 黒 */
            border-left: 8px solid #F8C300; /* 黄色のライン */
            padding-left: 15px;
            margin-top: 40px;
            margin-bottom: 25px;
            background-color: #fceb9a; /* 薄い黄色 */
            padding-top: 5px;
            padding-bottom: 5px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* 3列を基本に調整 */
            gap: 25px;
            margin-bottom: 40px;
        }
        .summary-item {
            background-color: #000; /* 黒 */
            color: #F8C300; /* 黄色 */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            text-align: center;
            border: 3px solid #F8C300;
            transition: transform 0.2s ease-in-out;
        }
        .summary-item:hover {
            transform: translateY(-5px) scale(1.02);
            background-color: #333; /* ホバーで少し暗く */
        }
        .summary-label {
            font-size: 1.2em;
            margin-bottom: 8px;
            color: #F8C300;
            display: block;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }
        .summary-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #fff; /* 数値は白で強調 */
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        /* ag-Gridテーマのカスタマイズ */
        .ag-theme-alpine {
            --ag-font-family: 'Meiryo UI', sans-serif;
            --ag-header-background-color: #F8C300; /* ヘッダーの背景を黄色に */
            --ag-header-foreground-color: #000; /* ヘッダーの文字を黒に */
            --ag-odd-row-background-color: #fff; /* 奇数行を白 */
            --ag-even-row-background-color: #ffeeaa; /* 偶数行を薄い黄色 */
            --ag-border-color: #F8C300; /* ボーダーを黄色に */
            --ag-row-hover-background-color: #ffda6a; /* ホバー時の行の色 */
            --ag-selected-row-background-color: #ffd033; /* 選択行の色 */
            --ag-active-color: #F8C300; /* アクティブな要素の色 */
            border: 3px solid #F8C300; /* グリッド全体の枠線 */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            overflow: hidden; /* 角丸を適用するために */
        }
        .ag-header-cell-text {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        /* Gridの高さ指定 */
        #myGrid { 
            width: 100%; 
            height: 500px; /* 固定の高さ */
            margin-bottom: 40px; 
        }
        
        /* セル内の詳細ボタン */
        .detail-btn { 
            font-size: 0.9em; 
            padding: 5px 10px; 
            margin-left: 8px; 
            background-color: #1a73e8; /* 別の色でボタンを区別 */
            color: #fff; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            transition: background-color 0.2s;
        }
        .detail-btn:hover {
            background-color: #155bb5;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 40px;
        }
        .action-buttons button {
            font-family: 'Meiryo UI', sans-serif;
            font-size: 1.5em;
            padding: 15px 40px;
            border-radius: 10px;
            border: 3px solid #000; /* 黒い枠線 */
            background-color: #F8C300; /* 黄色 */
            color: #000; /* 黒 */
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 3px 3px 8px rgba(0,0,0,0.4);
            text-shadow: 1px 1px 2px rgba(255,255,255,0.7);
        }
        .action-buttons button:hover {
            background-color: #ffe066; /* ホバーで少し明るく */
            transform: translateY(-3px);
            box-shadow: 5px 5px 12px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Hanshin_Tigers_logo.svg/1200px-Hanshin_Tigers_logo.svg.png" alt="Hanshin Tigers Logo" class="logo-left">
            <h1>今季もアレよ！</h1>
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Hanshin_Tigers_logo.svg/1200px-Hanshin_Tigers_logo.svg.png" alt="Hanshin Tigers Logo" class="logo-right">
        </div>

        <h2 class="section-title">お頼み申報酬</h2>
        <div class="summary-grid">
            <div class="summary-item">
                <span class="summary-label">事業別払込額・前</span>
                <span class="summary-value">1,200,000</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">事業別払込額・前</span>
                <span class="summary-value">850,000</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">事業別払込額・前</span>
                <span class="summary-value">640,000</span>
            </div>
        </div>

        <h2 class="section-title">サマミミイ</h2>
        <div class="summary-grid">
            <div class="summary-item">
                <span class="summary-label">事業別払込額・前</span>
                <span class="summary-value">1,200,000</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">事業別払込額・前</span>
                <span class="summary-value">850,000</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">事業別払込額・前</span>
                <span class="summary-value">640,000</span>
            </div>
        </div>

        <div id="myGrid" class="ag-theme-alpine"></div>

        <div class="action-buttons">
            <button onclick="alert('まけほー...')">戻る</button>
            <button onclick="alert('トラん買賃殿！')">トラん買賃殿</button>
            <button onclick="alert('払価劣れ牧牝')">払価劣れ牧牝</button>
        </div>
    </div>

    <script>
        // カラム定義
        const columnDefs = [
            {
                headerName: "お取引番号",
                field: "transactionId",
                minWidth: 200,
                cellRenderer: params => {
                    if (!params.value) return '';
                    return `<span>${params.value}</span><button class="detail-btn" onclick="alert('詳細を表示しまっせ！')">詳細</button>`;
                }
            },
            { headerName: "払込金額", field: "paymentAmount", minWidth: 130 },
            { headerName: "事業", field: "business", minWidth: 100 },
            { headerName: "元金", field: "principal", minWidth: 130 },
            { headerName: "利息", field: "interest", minWidth: 110 },
            { headerName: "遅延損害金", field: "lateCharges", minWidth: 140 },
            { headerName: "手数料", field: "fee", minWidth: 110 },
            { headerName: "未収利息", field: "uncollectedInterest", minWidth: 130 },
            { headerName: "未収遅延損害金", field: "uncollectedLateCharges", minWidth: 150 },
            { headerName: "約定入金除外対象日", field: "excludedDate", minWidth: 180 }
        ];

        // データ作成（サンプルデータと空行）
        const rowData = [
            {
                transactionId: '202406250001',
                paymentAmount: '2,000,001',
                business: '国民',
                principal: '1,100,001',
                interest: '30,000',
                lateCharges: '0',
                fee: '9,000',
                uncollectedInterest: '5,000',
                uncollectedLateCharges: '0',
                excludedDate: '2024/06/18'
            }
        ];

        for (let i = 0; i < 19; i++) { // 合計20行にするために19行追加
            rowData.push({});
        }

        // Gridのオプション設定
        const gridOptions = {
            columnDefs: columnDefs,
            rowData: rowData,
            defaultColDef: {
                resizable: true,
                sortable: true,
                filter: true,
                flex: 1, 
                minWidth: 100
            },
            suppressMovableColumns: true,
            suppressCellSelection: true
        };

        // ag-Grid初期化
        document.addEventListener('DOMContentLoaded', () => {
            const gridDiv = document.querySelector('#myGrid');
            agGrid.createGrid(gridDiv, gridOptions);
        });
    </script>
</body>
</html>
